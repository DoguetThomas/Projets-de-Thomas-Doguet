{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport API_URL from \"../components/apiUrl\";\nvar SIGN_IN = `\nmutation SignIn($username: String!, $password: String!) {\n  signIn(username: $username, password: $password)\n}\n`;\nvar SIGN_UP = `\nmutation SignUp($username: String!, $password: String!) {\n  signUp(username: $username, password: $password)\n}`;\nvar TODO_LISTS_QUERY = `\n  query TodoLists($where: TodoListWhere) {\n    todoLists(where: $where) {\n      id\n      title\n    }\n}\n`;\nexport function fetchTodoLists(_x, _x2) {\n  return _fetchTodoLists.apply(this, arguments);\n}\nfunction _fetchTodoLists() {\n  _fetchTodoLists = _asyncToGenerator(function* (token, username) {\n    try {\n      var response = yield fetch(API_URL, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          query: TODO_LISTS_QUERY,\n          variables: {\n            where: {\n              owner: {\n                id: token,\n                username: username\n              }\n            }\n          }\n        })\n      });\n      var result = yield response.json();\n      console.log('API Response:', result);\n      if (result.errors) {\n        throw new Error(result.errors.map(function (error) {\n          return error.message;\n        }).join(', '));\n      }\n      return result.data.todoLists;\n    } catch (error) {\n      console.error('Error fetching todo lists:', error);\n      throw new Error('Could not fetch todo lists');\n    }\n  });\n  return _fetchTodoLists.apply(this, arguments);\n}\nexport function signIn(username, password) {\n  return fetch(API_URL, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      query: SIGN_IN,\n      variables: {\n        username: username,\n        password: password\n      }\n    })\n  }).then(function (response) {\n    return response.json();\n  }).then(function (jsonResponse) {\n    if (jsonResponse.errors) {\n      throw jsonResponse.errors[0];\n    }\n    return jsonResponse.data.signIn;\n  }).catch(function (error) {\n    throw error;\n  });\n}\nexport function signUp(username, password) {\n  return fetch(API_URL, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      query: SIGN_UP,\n      variables: {\n        username: username,\n        password: password\n      }\n    })\n  }).then(function (response) {\n    return response.json();\n  }).then(function (jsonResponse) {\n    if (jsonResponse.errors) {\n      throw jsonResponse.errors[0];\n    }\n    return jsonResponse.data.signUp;\n  }).catch(function (error) {\n    throw error;\n  });\n}","map":{"version":3,"names":["API_URL","SIGN_IN","SIGN_UP","TODO_LISTS_QUERY","fetchTodoLists","_x","_x2","_fetchTodoLists","apply","arguments","_asyncToGenerator","token","username","response","fetch","method","headers","body","JSON","stringify","query","variables","where","owner","id","result","json","console","log","errors","Error","map","error","message","join","data","todoLists","signIn","password","then","jsonResponse","catch","signUp"],"sources":["/home/doguet221/Documents/l3/s1/programmationAppClient/tp4/util/SignIn.js"],"sourcesContent":["import API_URL from '../components/apiUrl';\n\n\nconst SIGN_IN = `\nmutation SignIn($username: String!, $password: String!) {\n  signIn(username: $username, password: $password)\n}\n`\n\nconst SIGN_UP = `\nmutation SignUp($username: String!, $password: String!) {\n  signUp(username: $username, password: $password)\n}`\n\nconst TODO_LISTS_QUERY = `\n  query TodoLists($where: TodoListWhere) {\n    todoLists(where: $where) {\n      id\n      title\n    }\n}\n`;\n\nexport async function fetchTodoLists(token, username) {\n  try {\n    const response = await fetch(API_URL, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        query: TODO_LISTS_QUERY,\n        variables: { \n          where: {\n            owner:{\n              id:token,\n              username: username\n            }\n        } },\n      }),\n    });\n\n    const result = await response.json();\n    console.log('API Response:', result);  // Ajoute ce log pour voir la réponse\n    \n    if (result.errors) {\n      throw new Error(result.errors.map(error => error.message).join(', '));\n    }\n\n    return result.data.todoLists;\n  } catch (error) {\n    console.error('Error fetching todo lists:', error);\n    throw new Error('Could not fetch todo lists');\n  }\n}\n\nexport function signIn(username, password) {\n    return fetch(API_URL, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        query: SIGN_IN,\n        variables: {\n          username: username,\n          password: password,\n        },\n      }),\n    })\n      .then((response) => response.json())\n      .then((jsonResponse) => {\n        if (jsonResponse.errors) {\n          throw jsonResponse.errors[0];\n        }\n        return jsonResponse.data.signIn; // Retourne le token (ou autre réponse) après connexion\n      })\n      .catch((error) => {\n        throw error;\n      });\n  }\n\n  export function signUp(username, password) {\n    return fetch(API_URL, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        query: SIGN_UP,\n        variables: {\n          username: username,\n          password: password,\n        },\n      }),\n    })\n      .then((response) => response.json())\n      .then((jsonResponse) => {\n        if (jsonResponse.errors) {\n          throw jsonResponse.errors[0];\n        }\n        return jsonResponse.data.signUp; // Retourne le token après inscription\n      })\n      .catch((error) => {\n        throw error;\n      });\n  }\n  "],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}